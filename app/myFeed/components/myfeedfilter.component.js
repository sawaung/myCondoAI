"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var router_1 = require("@angular/router");
var router_2 = require("nativescript-angular/router");
var myfeed_model_1 = require("../model/myfeed.model");
var myfeed_service_1 = require("../services/myfeed.service");
var nativescript_drop_down_1 = require("nativescript-drop-down");
var interfaces_1 = require("../../shared/interfaces");
var common_1 = require("@angular/common");
//import { DialogService } from '../../shared/utils/dialog.service';
var MyFeedFilterComponent = /** @class */ (function () {
    function MyFeedFilterComponent(router, route, routerExtensions, feedService) {
        this.router = router;
        this.route = route;
        this.routerExtensions = routerExtensions;
        this.feedService = feedService;
        this.dataSourceFeedType = new nativescript_drop_down_1.ValueList();
        this.dataSourceFeedCategory = new nativescript_drop_down_1.ValueList();
        this.feedFilterInfo = new myfeed_model_1.FeedFilter();
        this.isLoading = false;
    }
    MyFeedFilterComponent_1 = MyFeedFilterComponent;
    MyFeedFilterComponent.prototype.ngOnInit = function () {
        this.searchKeyword = "";
        this.initialize();
        this.init();
    };
    MyFeedFilterComponent.prototype.initialize = function () {
        this.feedFilterInfo.Feed_Category_Id = null;
        this.feedFilterInfo.FeedType_Id = null;
        this.feedFilterInfo.Title = null;
        this.feedFilterInfo.SearchKeyword = null;
        this.feedFilterInfo.Posted_Date_From = null;
        this.feedFilterInfo.Posted_Date_To = null;
        this.feedFilterInfo.Created_From = null;
        this.feedFilterInfo.Created_To = null;
        this.feedFilterInfo.Cursor_Index = null;
        this.feedFilterInfo.Get_Next = false;
        this.feedFilterInfo.Page_Size = 10;
        this.feedFilterInfo.Post_Status = true;
        this.feedFilterInfo.UnPost_Status = false;
        this.feedFilterInfo.isBlocked = false;
    };
    MyFeedFilterComponent.prototype.init = function () {
        //this.feedInfoDetail = new FeedInformation();
        //this.feedInfoDetail.Feed_Group = 1;
        //this.feedInfoDetail.Feed_Id = this.feedId;
        //this.feedInfoDetail = this.route.snapshot.params['id'];
        var _this = this;
        this.isLoading = true;
        this.feedService.getfeedType()
            .subscribe(function (res) {
            console.log("getFeedType -> " + JSON.stringify(res));
            _this.feedType = res.result;
            try {
                var dropDownValuePair;
                dropDownValuePair = new interfaces_1.DropDownValuePair();
                dropDownValuePair.value = "0";
                dropDownValuePair.display = "ALL";
                _this.dataSourceFeedType.push(dropDownValuePair);
                _this.feedType.map(function (v) {
                    dropDownValuePair = new interfaces_1.DropDownValuePair();
                    dropDownValuePair.value = v.FeedType_Id;
                    dropDownValuePair.display = v.FeedType_Name;
                    _this.dataSourceFeedType.push(dropDownValuePair);
                    //this.arrFeedType.push(v.FeedType_Name)
                });
                _this.dropDownFeedType.items = _this.dataSourceFeedType;
                _this.dropDownFeedType.selectedIndex = 0;
            }
            catch (e) {
                console.log(e);
            }
        });
        this.feedService.getfeedCategory()
            .subscribe(function (res) {
            _this.isLoading = false;
            _this.feedCategory = res.result;
            try {
                var dropDownValuePair;
                dropDownValuePair = new interfaces_1.DropDownValuePair();
                dropDownValuePair.value = "0";
                dropDownValuePair.display = "ALL";
                _this.dataSourceFeedCategory.push(dropDownValuePair);
                _this.feedCategory.map(function (v) {
                    dropDownValuePair = new interfaces_1.DropDownValuePair();
                    dropDownValuePair.value = v.Feed_Category_Id;
                    dropDownValuePair.display = v.Feed_Category_Name;
                    _this.dataSourceFeedCategory.push(dropDownValuePair);
                });
                _this.dropDownFeedCategory.items = _this.dataSourceFeedCategory;
                _this.dropDownFeedCategory.selectedIndex = 0;
            }
            catch (e) {
                console.log(e);
            }
        });
    };
    MyFeedFilterComponent.prototype.ngAfterViewInit = function () {
        this.page = this.pageRef.nativeElement;
        this.dropDownFeedType = this.page.getViewById("dropDownFeedType");
        this.dropDownFeedCategory = this.page.getViewById("dropDownFeedCategory");
        this.chkPost = this.page.getViewById("chkPost");
        this.chkUnpost = this.page.getViewById("chkUnpost");
        this.chkArchive = this.page.getViewById("chkArchive");
    };
    MyFeedFilterComponent.prototype.onNavBtnTap = function () {
        this.routerExtensions.backToPreviousPage();
    };
    MyFeedFilterComponent.prototype.onchangeFeedType = function (args) {
        var selectedValue = this.dataSourceFeedType.getValue(this.dropDownFeedType.selectedIndex);
        if (selectedValue.toString() != "0") {
            MyFeedFilterComponent_1.feedTypeId = selectedValue.toString();
        }
        console.log("selectedValue " + selectedValue);
        console.log("Drop Down selected index changed from " + args.oldIndex + " to " + args.newIndex);
    };
    MyFeedFilterComponent.prototype.onchangeFeedCategory = function (args) {
        var selectedValue = this.dataSourceFeedCategory.getValue(this.dropDownFeedCategory.selectedIndex);
        MyFeedFilterComponent_1.feedCategoryId = selectedValue.toString();
        console.log("selectedValue " + selectedValue);
        console.log("Drop Down selected index changed from " + args.oldIndex + " to " + args.newIndex);
    };
    MyFeedFilterComponent.prototype.onopen = function () {
    };
    MyFeedFilterComponent.prototype.onclose = function () {
    };
    MyFeedFilterComponent.prototype.onSearch = function () {
        this.feedFilterInfo.Feed_Category_Id = MyFeedFilterComponent_1.feedCategoryId;
        this.feedFilterInfo.FeedType_Id = MyFeedFilterComponent_1.feedTypeId;
        this.feedFilterInfo.UnPost_Status = this.chkUnpost.checked;
        this.feedFilterInfo.Post_Status = this.chkPost.checked;
        this.feedFilterInfo.isBlocked = this.chkArchive.checked;
        console.log("feedDetail --> " + JSON.stringify(this.feedFilterInfo));
        var navigationExtras = {
            queryParams: {
                "FeedFilterInfo": JSON.stringify(this.feedFilterInfo),
            }
        };
        this.router.navigate(["/myfeed/fiterresult"], navigationExtras);
    };
    MyFeedFilterComponent.prototype.callDatePicker = function (para) {
        var _this = this;
        var ModalPicker = require("nativescript-modal-datetimepicker").ModalDatetimepicker;
        var picker = new ModalPicker();
        picker.pickDate({
            title: "",
            theme: "light",
            maxDate: new Date(new Date().getFullYear(), 11, 31)
        }).then(function (result) {
            console.log("Date is: " + result.day + "-" + result.month + "-" + result.year);
            var _day = result.day;
            var _month = result.month;
            if (_day.toString().length < 2) {
                _day = "0" + _day;
            }
            if (_month.toString().length < 2) {
                _month = "0" + _month;
            }
            var strDate = new Date(result.year + "-" + _month + "-" + _day + "T00:00:00");
            var datePipe = new common_1.DatePipe("en-US");
            console.log("date 1 => " + strDate);
            var _date = datePipe.transform(strDate, 'dd MMM yyyy');
            console.log("date 2 => " + _date);
            if (para == "postedFrom") {
                _this.feedFilterInfo.Posted_Date_From = strDate;
                _this.postedDateFrom = _date;
            }
            else if (para == "postedTo") {
                _this.feedFilterInfo.Posted_Date_To = strDate;
                _this.postedDateTo = _date;
            }
            else if (para == "createdFrom") {
                _this.feedFilterInfo.Created_From = strDate;
                _this.createdDateFrom = _date;
            }
            else if (para == "createdTo") {
                _this.feedFilterInfo.Created_To = strDate;
                _this.createdDateTo = _date;
            }
        }).catch(function (error) {
            console.log("Error: " + error);
        });
    };
    MyFeedFilterComponent.feedCategoryId = "";
    MyFeedFilterComponent.feedTypeId = "";
    __decorate([
        core_1.ViewChild("page"),
        __metadata("design:type", core_1.ElementRef)
    ], MyFeedFilterComponent.prototype, "pageRef", void 0);
    MyFeedFilterComponent = MyFeedFilterComponent_1 = __decorate([
        core_1.Component({
            moduleId: module.id,
            selector: 'app-myfeedfilter',
            templateUrl: 'myfeedfilter.html',
            styleUrls: ['./myfeedfilter.component.css']
        }),
        __metadata("design:paramtypes", [router_1.Router, router_1.ActivatedRoute, router_2.RouterExtensions, myfeed_service_1.MyFeedService])
    ], MyFeedFilterComponent);
    return MyFeedFilterComponent;
    var MyFeedFilterComponent_1;
}());
exports.MyFeedFilterComponent = MyFeedFilterComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXlmZWVkZmlsdGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm15ZmVlZGZpbHRlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxzQ0FBeUU7QUFDekUsMENBQTJFO0FBQzNFLHNEQUErRDtBQUUvRCxzREFBa0c7QUFDbEcsNkRBQTJEO0FBSTNELGlFQUFtRDtBQUluRCxzREFBNEQ7QUFDNUQsMENBQTJDO0FBRzNDLG9FQUFvRTtBQVNwRTtJQXdCSSwrQkFBb0IsTUFBYyxFQUFVLEtBQXFCLEVBQVUsZ0JBQWtDLEVBQVUsV0FBMEI7UUFBN0gsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUFVLFVBQUssR0FBTCxLQUFLLENBQWdCO1FBQVUscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtRQUFVLGdCQUFXLEdBQVgsV0FBVyxDQUFlO1FBaEJqSix1QkFBa0IsR0FBRyxJQUFJLGtDQUFTLEVBQXFCLENBQUM7UUFDeEQsMkJBQXNCLEdBQUcsSUFBSSxrQ0FBUyxFQUFxQixDQUFDO1FBQzVELG1CQUFjLEdBQWUsSUFBSSx5QkFBVSxFQUFFLENBQUM7UUFFOUMsY0FBUyxHQUFZLEtBQUssQ0FBQztJQWMzQixDQUFDOzhCQTFCUSxxQkFBcUI7SUE0QjlCLHdDQUFRLEdBQVI7UUFDSSxJQUFJLENBQUMsYUFBYSxHQUFHLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDbEIsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2hCLENBQUM7SUFFRCwwQ0FBVSxHQUFWO1FBQ0ksSUFBSSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUM7UUFDNUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxjQUFjLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUNqQyxJQUFJLENBQUMsY0FBYyxDQUFDLGFBQWEsR0FBRyxJ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VyxFQUFFLG1CQUFtQjtZQUNoQyxTQUFTLEVBQUUsQ0FBQyw4QkFBOEIsQ0FBQztTQUM5QyxDQUFDO3lDQTBCOEIsZUFBTSxFQUFpQix1QkFBYyxFQUE0Qix5QkFBZ0IsRUFBdUIsOEJBQWE7T0F4QnhJLHFCQUFxQixDQWdOakM7SUFBRCw0QkFBQzs7Q0FBQSxBQWhORCxJQWdOQztBQWhOWSxzREFBcUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIFZpZXdDaGlsZCwgT25Jbml0LCBFbGVtZW50UmVmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBSb3V0ZXIsIEFjdGl2YXRlZFJvdXRlLCBOYXZpZ2F0aW9uRXh0cmFzIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IFJvdXRlckV4dGVuc2lvbnMgfSBmcm9tIFwibmF0aXZlc2NyaXB0LWFuZ3VsYXIvcm91dGVyXCI7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEZlZWRJbmZvcm1hdGlvbiwgRmVlZFR5cGUsIEZlZWRDYXRlZ29yeSwgRmVlZEZpbHRlciwgUm9sZSB9IGZyb20gJy4uL21vZGVsL215ZmVlZC5tb2RlbCc7XG5pbXBvcnQgeyBNeUZlZWRTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvbXlmZWVkLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ29tbW9uU2VydmljZSB9IGZyb20gJy4uLy4uL3NoYXJlZC91dGlscy9jb21tb24uc2VydmljZSc7XG5pbXBvcnQgeyBDb25maWdTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2hhcmVkL3V0aWxzL2NvbmZpZy5zZXJ2aWNlJztcblxuaW1wb3J0IHsgVmFsdWVMaXN0IH0gZnJvbSBcIm5hdGl2ZXNjcmlwdC1kcm9wLWRvd25cIjtcbmltcG9ydCB7IERyb3BEb3duIH0gZnJvbSBcIm5hdGl2ZXNjcmlwdC1kcm9wLWRvd24vZHJvcC1kb3duXCI7XG5pbXBvcnQgeyBQYWdlIH0gZnJvbSBcInVpL3BhZ2VcIjtcbmltcG9ydCB7IFNlbGVjdGVkSW5kZXhDaGFuZ2VkRXZlbnREYXRhIH0gZnJvbSBcIm5hdGl2ZXNjcmlwdC1kcm9wLWRvd25cIjtcbmltcG9ydCB7IERyb3BEb3duVmFsdWVQYWlyIH0gZnJvbSAnLi4vLi4vc2hhcmVkL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgRGF0ZVBpcGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgQ2hlY2tCb3ggfSBmcm9tICduYXRpdmVzY3JpcHQtY2hlY2tib3gnO1xuXG4vL2ltcG9ydCB7IERpYWxvZ1NlcnZpY2UgfSBmcm9tICcuLi8uLi9zaGFyZWQvdXRpbHMvZGlhbG9nLnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgICBtb2R1bGVJZDogbW9kdWxlLmlkLFxuICAgIHNlbGVjdG9yOiAnYXBwLW15ZmVlZGZpbHRlcicsXG4gICAgdGVtcGxhdGVVcmw6ICdteWZlZWRmaWx0ZXIuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vbXlmZWVkZmlsdGVyLmNvbXBvbmVudC5jc3MnXVxufSlcblxuZXhwb3J0IGNsYXNzIE15RmVlZEZpbHRlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG5cbiAgICBmZWVkVHlwZTogQXJyYXk8RmVlZFR5cGU+O1xuICAgIGZlZWRDYXRlZ29yeTogQXJyYXk8RmVlZENhdGVnb3J5PjtcbiAgICBwYWdlOiBQYWdlO1xuXG4gICAgZHJvcERvd25GZWVkVHlwZTogRHJvcERvd247XG4gICAgZHJvcERvd25GZWVkQ2F0ZWdvcnk6IERyb3BEb3duO1xuICAgIGRhdGFTb3VyY2VGZWVkVHlwZSA9IG5ldyBWYWx1ZUxpc3Q8RHJvcERvd25WYWx1ZVBhaXI+KCk7XG4gICAgZGF0YVNvdXJjZUZlZWRDYXRlZ29yeSA9IG5ldyBWYWx1ZUxpc3Q8RHJvcERvd25WYWx1ZVBhaXI+KCk7XG4gICAgZmVlZEZpbHRlckluZm86IEZlZWRGaWx0ZXIgPSBuZXcgRmVlZEZpbHRlcigpO1xuXG4gICAgaXNMb2FkaW5nOiBCb29sZWFuID0gZmFsc2U7XG5cbiAgICBzZWFyY2hLZXl3b3JkOnN0cmluZztcbiAgICBzdGF0aWMgZmVlZENhdGVnb3J5SWQ6c3RyaW5nID0gXCJcIjtcbiAgICBzdGF0aWMgZmVlZFR5cGVJZDpzdHJpbmcgPSBcIlwiO1xuICAgIHBvc3RlZERhdGVGcm9tOnN0cmluZztwb3N0ZWREYXRlVG86c3RyaW5nO1xuICAgIHBvc3RTdGF0dXM6c3RyaW5nOyB1bnBvc3RTdGF0dXM6c3RyaW5nOyBibG9jazpzdHJpbmc7XG4gICAgY3JlYXRlZERhdGVGcm9tOnN0cmluZztjcmVhdGVkRGF0ZVRvOnN0cmluZztcbiAgICBjaGtQb3N0OkNoZWNrQm94O2Noa1VucG9zdDpDaGVja0JveDtjaGtBcmNoaXZlOkNoZWNrQm94O1xuXG5cbiAgICBAVmlld0NoaWxkKFwicGFnZVwiKSBwYWdlUmVmOiBFbGVtZW50UmVmO1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsIHByaXZhdGUgcm91dGU6IEFjdGl2YXRlZFJvdXRlLCBwcml2YXRlIHJvdXRlckV4dGVuc2lvbnM6IFJvdXRlckV4dGVuc2lvbnMsIHByaXZhdGUgZmVlZFNlcnZpY2U6IE15RmVlZFNlcnZpY2UpIHtcblxuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnNlYXJjaEtleXdvcmQgPSBcIlwiO1xuICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcbiAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgdGhpcy5mZWVkRmlsdGVySW5mby5GZWVkX0NhdGVnb3J5X0lkID0gbnVsbDtcbiAgICAgICAgdGhpcy5mZWVkRmlsdGVySW5mby5GZWVkVHlwZV9JZCA9IG51bGw7XG4gICAgICAgIHRoaXMuZmVlZEZpbHRlckluZm8uVGl0bGUgPSBudWxsO1xuICAgICAgICB0aGlzLmZlZWRGaWx0ZXJJbmZvLlNlYXJjaEtleXdvcmQgPSBudWxsO1xuICAgICAgICB0aGlzLmZlZWRGaWx0ZXJJbmZvLlBvc3RlZF9EYXRlX0Zyb20gPSBudWxsO1xuICAgICAgICB0aGlzLmZlZWRGaWx0ZXJJbmZvLlBvc3RlZF9EYXRlX1RvID0gbnVsbDtcbiAgICAgICAgdGhpcy5mZWVkRmlsdGVySW5mby5DcmVhdGVkX0Zyb20gPSBudWxsO1xuICAgICAgICB0aGlzLmZlZWRGaWx0ZXJJbmZvLkNyZWF0ZWRfVG8gPSBudWxsO1xuICAgICAgICB0aGlzLmZlZWRGaWx0ZXJJbmZvLkN1cnNvcl9JbmRleCA9IG51bGw7XG4gICAgICAgIHRoaXMuZmVlZEZpbHRlckluZm8uR2V0X05leHQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5mZWVkRmlsdGVySW5mby5QYWdlX1NpemUgPSAxMDtcbiAgICAgICAgdGhpcy5mZWVkRmlsdGVySW5mby5Qb3N0X1N0YXR1cyA9IHRydWU7XG4gICAgICAgIHRoaXMuZmVlZEZpbHRlckluZm8uVW5Qb3N0X1N0YXR1cyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmZlZWRGaWx0ZXJJbmZvLmlzQmxvY2tlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIGluaXQoKSB7XG4gICAgICAgIC8vdGhpcy5mZWVkSW5mb0RldGFpbCA9IG5ldyBGZWVkSW5mb3JtYXRpb24oKTtcbiAgICAgICAgLy90aGlzLmZlZWRJbmZvRGV0YWlsLkZlZWRfR3JvdXAgPSAxO1xuICAgICAgICAvL3RoaXMuZmVlZEluZm9EZXRhaWwuRmVlZF9JZCA9IHRoaXMuZmVlZElkO1xuICAgICAgICAvL3RoaXMuZmVlZEluZm9EZXRhaWwgPSB0aGlzLnJvdXRlLnNuYXBzaG90LnBhcmFtc1snaWQnXTtcblxuXG4gICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcblxuXG4gICAgICAgIHRoaXMuZmVlZFNlcnZpY2UuZ2V0ZmVlZFR5cGUoKVxuICAgICAgICAgICAgLnN1YnNjcmliZShyZXMgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0RmVlZFR5cGUgLT4gXCIgKyBKU09OLnN0cmluZ2lmeShyZXMpKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuZmVlZFR5cGUgPSByZXMucmVzdWx0O1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkcm9wRG93blZhbHVlUGFpcjtcbiAgICAgICAgICAgICAgICAgICAgZHJvcERvd25WYWx1ZVBhaXIgPSBuZXcgRHJvcERvd25WYWx1ZVBhaXIoKTtcbiAgICAgICAgICAgICAgICAgICAgZHJvcERvd25WYWx1ZVBhaXIudmFsdWUgPSBcIjBcIjtcbiAgICAgICAgICAgICAgICAgICAgZHJvcERvd25WYWx1ZVBhaXIuZGlzcGxheSA9IFwiQUxMXCI7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNvdXJjZUZlZWRUeXBlLnB1c2goZHJvcERvd25WYWx1ZVBhaXIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZlZWRUeXBlLm1hcCgodikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZHJvcERvd25WYWx1ZVBhaXIgPSBuZXcgRHJvcERvd25WYWx1ZVBhaXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BEb3duVmFsdWVQYWlyLnZhbHVlID0gdi5GZWVkVHlwZV9JZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BEb3duVmFsdWVQYWlyLmRpc3BsYXkgPSB2LkZlZWRUeXBlX05hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFTb3VyY2VGZWVkVHlwZS5wdXNoKGRyb3BEb3duVmFsdWVQYWlyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5hcnJGZWVkVHlwZS5wdXNoKHYuRmVlZFR5cGVfTmFtZSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHJvcERvd25GZWVkVHlwZS5pdGVtcyA9IHRoaXMuZGF0YVNvdXJjZUZlZWRUeXBlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyb3BEb3duRmVlZFR5cGUuc2VsZWN0ZWRJbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmZlZWRTZXJ2aWNlLmdldGZlZWRDYXRlZ29yeSgpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLmZlZWRDYXRlZ29yeSA9IHJlcy5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRyb3BEb3duVmFsdWVQYWlyO1xuICAgICAgICAgICAgICAgICAgICBkcm9wRG93blZhbHVlUGFpciA9IG5ldyBEcm9wRG93blZhbHVlUGFpcigpO1xuICAgICAgICAgICAgICAgICAgICBkcm9wRG93blZhbHVlUGFpci52YWx1ZSA9IFwiMFwiO1xuICAgICAgICAgICAgICAgICAgICBkcm9wRG93blZhbHVlUGFpci5kaXNwbGF5ID0gXCJBTExcIjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhU291cmNlRmVlZENhdGVnb3J5LnB1c2goZHJvcERvd25WYWx1ZVBhaXIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZlZWRDYXRlZ29yeS5tYXAoKHYpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BEb3duVmFsdWVQYWlyID0gbmV3IERyb3BEb3duVmFsdWVQYWlyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wRG93blZhbHVlUGFpci52YWx1ZSA9IHYuRmVlZF9DYXRlZ29yeV9JZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BEb3duVmFsdWVQYWlyLmRpc3BsYXkgPSB2LkZlZWRfQ2F0ZWdvcnlfTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNvdXJjZUZlZWRDYXRlZ29yeS5wdXNoKGRyb3BEb3duVmFsdWVQYWlyKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcm9wRG93bkZlZWRDYXRlZ29yeS5pdGVtcyA9IHRoaXMuZGF0YVNvdXJjZUZlZWRDYXRlZ29yeTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcm9wRG93bkZlZWRDYXRlZ29yeS5zZWxlY3RlZEluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgICAgIHRoaXMucGFnZSA9IHRoaXMucGFnZVJlZi5uYXRpdmVFbGVtZW50O1xuICAgICAgICB0aGlzLmRyb3BEb3duRmVlZFR5cGUgPSB0aGlzLnBhZ2UuZ2V0Vmlld0J5SWQ8RHJvcERvd24+KFwiZHJvcERvd25GZWVkVHlwZVwiKTtcbiAgICAgICAgdGhpcy5kcm9wRG93bkZlZWRDYXRlZ29yeSA9IHRoaXMucGFnZS5nZXRWaWV3QnlJZDxEcm9wRG93bj4oXCJkcm9wRG93bkZlZWRDYXRlZ29yeVwiKTtcblxuICAgICAgICB0aGlzLmNoa1Bvc3QgPSB0aGlzLnBhZ2UuZ2V0Vmlld0J5SWQ8Q2hlY2tCb3g+KFwiY2hrUG9zdFwiKTtcbiAgICAgICAgdGhpcy5jaGtVbnBvc3QgPSB0aGlzLnBhZ2UuZ2V0Vmlld0J5SWQ8Q2hlY2tCb3g+KFwiY2hrVW5wb3N0XCIpO1xuICAgICAgICB0aGlzLmNoa0FyY2hpdmUgPSB0aGlzLnBhZ2UuZ2V0Vmlld0J5SWQ8Q2hlY2tCb3g+KFwiY2hrQXJjaGl2ZVwiKTtcblxuICAgIH1cblxuICAgIG9uTmF2QnRuVGFwKCkge1xuICAgICAgICB0aGlzLnJvdXRlckV4dGVuc2lvbnMuYmFja1RvUHJldmlvdXNQYWdlKCk7XG4gICAgfVxuXG4gICAgb25jaGFuZ2VGZWVkVHlwZShhcmdzOiBTZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50RGF0YSkge1xuICAgICAgICBsZXQgc2VsZWN0ZWRWYWx1ZSA9IHRoaXMuZGF0YVNvdXJjZUZlZWRUeXBlLmdldFZhbHVlKHRoaXMuZHJvcERvd25GZWVkVHlwZS5zZWxlY3RlZEluZGV4KTtcbiAgICAgICAgaWYoc2VsZWN0ZWRWYWx1ZS50b1N0cmluZygpICE9IFwiMFwiKXtcbiAgICAgICAgICAgIE15RmVlZEZpbHRlckNvbXBvbmVudC5mZWVkVHlwZUlkID0gc2VsZWN0ZWRWYWx1ZS50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKFwic2VsZWN0ZWRWYWx1ZSBcIiArIHNlbGVjdGVkVmFsdWUpO1xuICAgICAgICBjb25zb2xlLmxvZyhgRHJvcCBEb3duIHNlbGVjdGVkIGluZGV4IGNoYW5nZWQgZnJvbSAke2FyZ3Mub2xkSW5kZXh9IHRvICR7YXJncy5uZXdJbmRleH1gKTtcbiAgICB9XG4gICAgb25jaGFuZ2VGZWVkQ2F0ZWdvcnkoYXJnczogU2VsZWN0ZWRJbmRleENoYW5nZWRFdmVudERhdGEpIHtcbiAgICAgICAgbGV0IHNlbGVjdGVkVmFsdWUgPSB0aGlzLmRhdGFTb3VyY2VGZWVkQ2F0ZWdvcnkuZ2V0VmFsdWUodGhpcy5kcm9wRG93bkZlZWRDYXRlZ29yeS5zZWxlY3RlZEluZGV4KTtcbiAgICAgICAgTXlGZWVkRmlsdGVyQ29tcG9uZW50LmZlZWRDYXRlZ29yeUlkID0gc2VsZWN0ZWRWYWx1ZS50b1N0cmluZygpO1xuICAgICAgICBjb25zb2xlLmxvZyhcInNlbGVjdGVkVmFsdWUgXCIgKyBzZWxlY3RlZFZhbHVlKTtcbiAgICAgICAgY29uc29sZS5sb2coYERyb3AgRG93biBzZWxlY3RlZCBpbmRleCBjaGFuZ2VkIGZyb20gJHthcmdzLm9sZEluZGV4fSB0byAke2FyZ3MubmV3SW5kZXh9YCk7XG4gICAgfVxuICAgIG9ub3BlbigpIHtcblxuICAgIH1cbiAgICBvbmNsb3NlKCkge1xuXG4gICAgfVxuXG4gICAgb25TZWFyY2goKXtcbiAgICAgICAgdGhpcy5mZWVkRmlsdGVySW5mby5GZWVkX0NhdGVnb3J5X0lkID0gTXlGZWVkRmlsdGVyQ29tcG9uZW50LmZlZWRDYXRlZ29yeUlkO1xuICAgICAgICB0aGlzLmZlZWRGaWx0ZXJJbmZvLkZlZWRUeXBlX0lkID0gTXlGZWVkRmlsdGVyQ29tcG9uZW50LmZlZWRUeXBlSWQ7XG5cbiAgICAgICAgdGhpcy5mZWVkRmlsdGVySW5mby5VblBvc3RfU3RhdHVzID0gdGhpcy5jaGtVbnBvc3QuY2hlY2tlZDtcbiAgICAgICAgdGhpcy5mZWVkRmlsdGVySW5mby5Qb3N0X1N0YXR1cyA9IHRoaXMuY2hrUG9zdC5jaGVja2VkO1xuICAgICAgICB0aGlzLmZlZWRGaWx0ZXJJbmZvLmlzQmxvY2tlZCA9IHRoaXMuY2hrQXJjaGl2ZS5jaGVja2VkO1xuICAgICAgICBjb25zb2xlLmxvZyhcImZlZWREZXRhaWwgLS0+IFwiICsgSlNPTi5zdHJpbmdpZnkodGhpcy5mZWVkRmlsdGVySW5mbykpO1xuXG4gICAgICAgIGxldCBuYXZpZ2F0aW9uRXh0cmFzOiBOYXZpZ2F0aW9uRXh0cmFzID0ge1xuICAgICAgICAgICAgcXVlcnlQYXJhbXM6IHtcbiAgICAgICAgICAgICAgICBcIkZlZWRGaWx0ZXJJbmZvXCIgOiBKU09OLnN0cmluZ2lmeSh0aGlzLmZlZWRGaWx0ZXJJbmZvKSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuXG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcIi9teWZlZWQvZml0ZXJyZXN1bHRcIl0sbmF2aWdhdGlvbkV4dHJhcyk7XG4gICAgfVxuXG4gICAgY2FsbERhdGVQaWNrZXIocGFyYSkge1xuXG4gICAgICAgIGNvbnN0IE1vZGFsUGlja2VyID0gcmVxdWlyZShcIm5hdGl2ZXNjcmlwdC1tb2RhbC1kYXRldGltZXBpY2tlclwiKS5Nb2RhbERhdGV0aW1lcGlja2VyO1xuICAgICAgICBjb25zdCBwaWNrZXIgPSBuZXcgTW9kYWxQaWNrZXIoKTtcbiAgICAgICAgcGlja2VyLnBpY2tEYXRlKHtcbiAgICAgICAgICAgIHRpdGxlOiBcIlwiLFxuICAgICAgICAgICAgdGhlbWU6IFwibGlnaHRcIixcbiAgICAgICAgICAgIG1heERhdGU6IG5ldyBEYXRlKG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSwgMTEsIDMxKVxuICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0ZSBpczogXCIgKyByZXN1bHQuZGF5ICsgXCItXCIgKyByZXN1bHQubW9udGggKyBcIi1cIiArIHJlc3VsdC55ZWFyKTtcbiAgICAgICAgICAgIHZhciBfZGF5OiBzdHJpbmcgPSByZXN1bHQuZGF5O1xuICAgICAgICAgICAgdmFyIF9tb250aDpzdHJpbmcgPSByZXN1bHQubW9udGg7XG4gICAgICAgICAgICBpZiAoX2RheS50b1N0cmluZygpLmxlbmd0aCA8IDIpIHsgX2RheSA9IFwiMFwiICsgX2RheTsgfVxuICAgICAgICAgICAgaWYgKF9tb250aC50b1N0cmluZygpLmxlbmd0aCA8IDIpIHsgX21vbnRoID0gXCIwXCIgKyBfbW9udGg7IH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHN0ckRhdGUgPSBuZXcgRGF0ZShyZXN1bHQueWVhciArIFwiLVwiICsgX21vbnRoICsgXCItXCIgKyBfZGF5ICsgXCJUMDA6MDA6MDBcIik7XG4gICAgICAgICAgICB2YXIgZGF0ZVBpcGUgPSBuZXcgRGF0ZVBpcGUoXCJlbi1VU1wiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGF0ZSAxID0+IFwiICsgc3RyRGF0ZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxldCBfZGF0ZTogYW55ID0gZGF0ZVBpcGUudHJhbnNmb3JtKHN0ckRhdGUsICdkZCBNTU0geXl5eScpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJkYXRlIDIgPT4gXCIgKyBfZGF0ZSk7XG4gICAgICAgICAgICBpZiAocGFyYSA9PSBcInBvc3RlZEZyb21cIikge1xuICAgICAgICAgICAgICAgIHRoaXMuZmVlZEZpbHRlckluZm8uUG9zdGVkX0RhdGVfRnJvbSA9IHN0ckRhdGU7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3N0ZWREYXRlRnJvbSA9IF9kYXRlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJhID09IFwicG9zdGVkVG9cIikge1xuICAgICAgICAgICAgICAgIHRoaXMuZmVlZEZpbHRlckluZm8uUG9zdGVkX0RhdGVfVG8gPSBzdHJEYXRlO1xuICAgICAgICAgICAgICAgIHRoaXMucG9zdGVkRGF0ZVRvID0gX2RhdGU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhcmEgPT0gXCJjcmVhdGVkRnJvbVwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mZWVkRmlsdGVySW5mby5DcmVhdGVkX0Zyb20gPSBzdHJEYXRlO1xuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlZERhdGVGcm9tID0gX2RhdGU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhcmEgPT0gXCJjcmVhdGVkVG9cIikge1xuICAgICAgICAgICAgICAgIHRoaXMuZmVlZEZpbHRlckluZm8uQ3JlYXRlZF9UbyA9IHN0ckRhdGU7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVkRGF0ZVRvID0gX2RhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjogXCIgKyBlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdfQ==